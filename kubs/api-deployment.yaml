apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: analysis-api
  labels:
    app: analysis-api  
spec:
  selector:
    matchLabels:
      app: analysis-api
  template:
    metadata:
      labels:
        app: analysis-api  
    spec:    
      imagePullSecrets:
        - name: private-registry-key
      containers:
      - name: analysis-api
        image: phelimb/mykrobe-atlas-analysis-api:cc60052-3
        imagePullPolicy: Never
        command: ["flask"]
        args: ["run", "--port", "8080"]
        ports:
          - containerPort: 8080
---
apiVersion: v1
kind: Service
metadata:
  name: analysis-api
  labels:
    app: analysis-api
spec:
  type: NodePort
  ports:
  - port: 8080
    targetPort: 8080     
  selector:
    app: analysis-api
